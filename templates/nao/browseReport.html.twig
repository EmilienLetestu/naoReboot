{% extends "base.html.twig" %}

{% block title %}
    {{ parent() }} Découvrez les derniers oiseaux observés par nos membres
{% endblock %}

{% block body %}


    <div>
        <h1 class="pageTitle">{{ title }}</h1>
    </div>

    <div class="filter">
        <i class="material-icons" v-on:mouseover="filter = true" v-show ="!filter">keyboard_arrow_down</i>
            {{ form_start(filter, {'attr':{'class' : 'form-inline','v-show' : 'filter'}}) }}
            <div class="form-group-row">
                {{ form_widget(filter.order) }}
            </div>
            <div>
                {{ form_widget(filter.bird) }}
            </div>
            <div class="form-group-row">
                <i class="material-icons" v-on:click="filter = false">close</i>
                <button class="btn btn-success" type="submit">Valider</button>
            </div>
            {{ form_end(filter) }}
      </div>

    {% if  birdId is defined and birdId != null and app.request.getPathInfo == '/observations/valide' %}
    <div id ="map"></div>
    <div>
        <table class="table">
            <thead>
                <tr>
                    <th>Nombre de spécimens</th>
                    <th>Spécimens par observation</th>
                    <th>Dernière observation</th>
                    <th>Coordonnées</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <th>{{ birdId|statistics['population'] }}</th>
                    <th>{{ birdId|statistics['avgByReport'] }}</th>
                    <th>{{ birdId|lastReported['date'] }}</th>
                    <th>{{ birdId|lastReported['satNav'] }}</th>
                </tr>
            </tbody>
        </table>
    </div>
    {% endif %}

    <div class="cardHolder">
        {% for report in reports %}
            <input type="hidden"  class="locations" value="{{ report.satNav }}">
            {{ include('nao/reportCard.html.twig') }}
        {% endfor %}
    </div>

{% endblock %}
{% block javascripts %}
    <script src="{{ asset('vueJs/ux.js') }}"></script>
    {% if  birdId is defined and birdId != null %}
        <script src="{{ asset('js/maps.js') }}"></script>
    {% else %}
        <script src="{{ asset('js/reportMap.js') }}"></script>
    {% endif %}
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDcUhS0gzRBMh-V_lIwHotjxGbMFQHCczg"
            type="text/javascript"></script>
{% endblock %}

